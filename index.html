<script>
const COIN_TO_RUPEE=0.1, DAILY_CAP=1000, MIN_WITHDRAW=200;
let state={coins:0,daily:0,isWalking:false};
let timer;

// ðŸŸ¢ Load saved state from localStorage
function loadState(){
  let saved=localStorage.getItem("walkfor_state");
  if(saved){
    state=JSON.parse(saved);
  }
}
function saveState(){
  localStorage.setItem("walkfor_state", JSON.stringify(state));
}

// midnight reset check
function checkMidnight(){
  let now=new Date();
  if(now.getHours()===0 && now.getMinutes()===0 && now.getSeconds()===0){
    state.daily=0;
    log('New day reset, you can earn again.');
    updateUI();
    saveState();
  }
}

function log(msg){
  let ul=document.getElementById('activityList');
  let li=document.createElement('li');
  li.innerText=new Date().toLocaleTimeString()+" â€” "+msg;
  ul.prepend(li);
}
function updateUI(){
  document.getElementById('coins').innerText=Math.floor(state.coins);
  document.getElementById('rupee').innerText=Math.floor(state.coins*COIN_TO_RUPEE);
  document.getElementById('earned').innerText=Math.floor(state.daily);
}

document.getElementById('startBtn').onclick=()=>{
  if(state.isWalking){
    state.isWalking=false;
    clearInterval(timer);
    document.getElementById('status').innerText='Stopped';
    log('Stopped manually');
    saveState();
    return;
  }
  if(state.daily>=DAILY_CAP){
    alert('Daily cap reached (1000 coins). Try tomorrow.');
    return;
  }
  state.isWalking=true;
  document.getElementById('status').innerText='Walking';
  log('Started walking');
  timer=setInterval(()=>{
    state.daily+=1; // pehle sirf daily me add hoga
    updateUI();
    saveState();
    if(state.daily>=DAILY_CAP){
      clearInterval(timer);
      state.isWalking=false;
      document.getElementById('status').innerText='Daily cap reached';
      log('Stopped automatically at 1000 coins');
      saveState();
    }
    checkMidnight();
  },1000);
};

// Claim button logic
document.getElementById('claimBtn').onclick=()=>{
  let available=Math.floor(state.daily);
  if(available<=0){
    alert('No coins available to claim');
    return;
  }
  if(available>DAILY_CAP){
    available=DAILY_CAP;
  }
  state.coins+=available;
  state.daily=0; // reset daily after claim
  updateUI();
  saveState();
  log('Claimed '+available+' coins into wallet');
};

document.getElementById('withdrawBtn').onclick=()=>{
  let amt=Number(document.getElementById('withdrawAmount').value);
  if(amt<MIN_WITHDRAW){
    alert('Minimum withdraw is â‚¹'+MIN_WITHDRAW);
    return;
  }
  let need=amt/COIN_TO_RUPEE;
  if(state.coins<need){
    alert('Not enough coins');
    return;
  }
  state.coins-=need;
  updateUI();
  saveState();
  log('Withdraw requested â‚¹'+amt+' ('+Math.floor(need)+' coins). Pending...');
  alert('Withdraw request pending (for demo).');
};

// ðŸŸ¢ Load saved state at start
loadState();
updateUI();
      </script>
